<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대시보드 - RepurposeAI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
</head>
<body class="bg-gray-100 dark:bg-dark-bg text-gray-900 dark:text-gray-100 min-h-screen font-sans transition-colors duration-300">

    <!-- Header -->
    <header class="bg-white/80 dark:bg-dark-card/80 backdrop-blur-md sticky top-0 z-50 border-b border-gray-200 dark:border-dark-border">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <a href="index.html" class="flex items-center gap-2.5">
                <div class="bg-brand text-white p-2 rounded-lg shadow-sm">
                    <i data-lucide="sparkles" class="w-5 h-5"></i>
                </div>
                <h1 class="text-xl font-bold tracking-tight text-brand dark:text-brand-light hidden sm:block">RepurposeAI</h1>
            </a>
            
            <div class="flex items-center gap-4">
                <span id="user-name" class="text-sm font-medium text-gray-600 dark:text-gray-300 hidden md:block">User</span>
                <button id="logout-btn" class="text-sm text-red-500 hover:text-red-600 font-medium transition-colors">
                    로그아웃
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
            <div>
                <h2 class="text-2xl font-bold flex items-center gap-2">
                    <i data-lucide="history" class="w-6 h-6 text-brand"></i>
                    생성 기록
                </h2>
                <p class="text-gray-500 dark:text-gray-400 mt-1">최근 생성하신 콘텐츠 목록입니다.</p>
            </div>
            <a href="index.html" class="bg-brand hover:bg-brand-dark text-white text-sm font-medium px-4 py-2.5 rounded-lg shadow transition-all flex items-center gap-2">
                <i data-lucide="plus" class="w-4 h-4"></i>
                새 콘텐츠 생성
            </a>
        </div>

        <!-- History List (Empty State initially) -->
        <div id="history-container" class="space-y-4">
            <!-- Items will be injected here -->
        </div>

        <div id="empty-state" class="hidden flex flex-col items-center justify-center bg-white dark:bg-dark-card rounded-xl border border-dashed border-gray-300 dark:border-dark-border p-12 text-center text-gray-500 dark:text-gray-400">
            <i data-lucide="inbox" class="w-12 h-12 mb-4 opacity-50"></i>
            <p class="text-lg font-medium">아직 생성된 기록이 없습니다.</p>
            <p class="text-sm mt-1">새로운 콘텐츠를 만들어보세요!</p>
        </div>

    </main>

    <script src="js/theme.js"></script>
    <script>
        lucide.createIcons();

        // Auth Check
        const user = JSON.parse(localStorage.getItem('rep_user'));
        if (!user) {
            window.location.href = 'login.html';
        } else {
            document.getElementById('user-name').textContent = user.name;
        }

        // Logout
        document.getElementById('logout-btn').addEventListener('click', () => {
            localStorage.removeItem('rep_user');
            window.location.href = 'index.html';
        });

        // Load History
        const history = JSON.parse(localStorage.getItem('rep_history') || '[]');
        const container = document.getElementById('history-container');
        const emptyState = document.getElementById('empty-state');

        if (history.length === 0) {
            emptyState.classList.remove('hidden');
        } else {
            history.reverse().forEach(item => {
                const date = new Date(item.timestamp).toLocaleDateString() + ' ' + new Date(item.timestamp).toLocaleTimeString();
                
                const card = document.createElement('div');
                card.className = 'bg-white dark:bg-dark-card p-5 rounded-xl border border-gray-200 dark:border-dark-border shadow-sm hover:shadow-md transition-shadow group';
                
                // Platform Icon Map
                let platformIcon = 'file-text';
                if(item.platform === 'twitter') platformIcon = 'twitter';
                if(item.platform === 'linkedin') platformIcon = 'linkedin';
                if(item.platform === 'instagram') platformIcon = 'instagram';
                if(item.platform === 'youtube') platformIcon = 'youtube';

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400">
                            <i data-lucide="${platformIcon}" class="w-4 h-4"></i>
                            <span class="capitalize">${item.platform}</span>
                            <span class="mx-1">•</span>
                            <span>${date}</span>
                        </div>
                        <button class="copy-item-btn text-brand font-medium text-xs hover:underline flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity" data-content="${encodeURIComponent(item.content)}">
                            <i data-lucide="copy" class="w-3 h-3"></i> 복사
                        </button>
                    </div>
                    <div class="text-gray-800 dark:text-gray-200 text-sm whitespace-pre-wrap line-clamp-3">${item.content}</div>
                `;
                container.appendChild(card);
            });
            lucide.createIcons();

            // Handle Copy Buttons inside list
            document.querySelectorAll('.copy-item-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const content = decodeURIComponent(e.currentTarget.dataset.content);
                    navigator.clipboard.writeText(content);
                    e.currentTarget.innerHTML = '<i data-lucide="check" class="w-3 h-3"></i> 복사됨';
                    setTimeout(() => {
                        e.currentTarget.innerHTML = '<i data-lucide="copy" class="w-3 h-3"></i> 복사';
                        lucide.createIcons();
                    }, 2000);
                });
            });
        }
    </script>
</body>
</html>
